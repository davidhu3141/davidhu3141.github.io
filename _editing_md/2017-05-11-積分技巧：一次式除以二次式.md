---
layout: post
title:  "積分技巧：一次式除以二次式"
date:   2017-05-11 00:00:00 +0800
categories: 高中教材
---


積分技巧：一次式除以二次式
=========================

一次式除以二次式的積分 $$\int \frac{mx+n}{ax^2+bx+c} \mathop{dx}$$總是可以算。認知到這件事是很方便的，可以進一步推導出多項式除以多項式的積分的一般算法。

分母是二次式時，情況分兩種：分母有實根，或沒有實根。我將示範兩種情況的算法。

<!-- TOC -->

- [分母的二次式有兩實根](#分母的二次式有兩實根)
    - [部份分式](#部份分式)
    - [Sol.](#sol)
- [分母的二次式有重根](#分母的二次式有重根)
- [分母的二次式沒有實根](#分母的二次式沒有實根)
    - [需要的公式](#需要的公式)
    - [sol.](#sol)
- [定理](#定理)
- [推論](#推論)

<!-- /TOC -->

### 分母的二次式有兩實根

> Find the anti-derivative: $$\int \frac{x+1}{x^2-4x+3} \mathop{dx} $$

#### 部份分式

我們要先將分式拆成兩個小分式：

$$\frac{x+1}{x^2-4x+3} =  \frac{x+1}{(x-3)(x-1)} = \frac{2}{x-3} - \frac{1}{x-1}$$

上面的做法稱做部份分式（不是分部積分）。現在的課綱高一都不教這個了，不過這也不難。反正分母可以分解的話就一定可以拆成兩個分式。

但是怎麼知道右式分子是多少？不知道的話只要假設 $$\frac{x+1}{x^2-4x+3} =\frac{A}{x-3} + \frac{B}{x-1}$$，右邊通分後與左式比較係數即可。

#### Sol.

因此原式

$$\int \frac{3x+4}{x^2-4x+3} \mathop{dx} = \int \frac{2}{x-3} - \frac{1}{x-1} \mathop{dx}$$

又我們有 $\int \frac{1}{x-a} \mathop{dx}=\operatorname{ln}(x-a) $，因此 

$$\int \frac{2}{x-3} - \frac{1}{x-1} \mathop{dx} = 2\ln |x-3| - \ln |x-1| + C.$$

這樣就算完了。


### 分母的二次式有重根

重根就好辦了。

> Find the anti-derivative: $$\int \frac{x-4}{(x-3)^2} \mathop{dx}$$

只要將分子寫成 $(x-3)$ 的多項式再拆開：

$$\int \frac{x-4}{(x-3)^2} \mathop{dx} = \int \frac{(x-3)-1}{(x-3)^2} \mathop{dx} = \int (x-3)^{-1} - (x-3)^{-2} \mathop{dx}$$

接下來跟多項式一樣，就不寫了。

另一方面，要把它寫成部份分式也是可以的，但要假設它拆開後的形式為

$$ \frac{A}{(x-3)^2} + \frac{B}{(x-3)} $$

再去通分比較係數。

*我也沒辦法找個自己滿意的答案來說服自己為甚麼要這樣做。*

### 分母的二次式沒有實根

> Find the anti-derivative:
> $$\int \frac{x+3}{x^2+2x+2}\ dx$$

#### 需要的公式

由於 $\int \frac{1}{1+x^2} \mathop{dx}= \arctan x$ ，因此令 $u=ax$（$a$是常數） 可以進一步推導出

> $$\int \frac{1}{u^2 + a^2}\ du = \frac{1}{a}\arctan\frac{u}{a}$$


#### sol. 

先將分母配方，並且把分子處理一下：

$$ \begin{aligned} \int \frac{x+3}{x^2+2x+2}\ dx &= \int  \frac{(x+1)+2}{(x+1)^2+1}\ dx \\ &= \int \frac{x+1}{(x+1)^2+1} + \frac{2}{(x+1)^2+1} \ dx \\ &=  \int \frac{x+1}{(x+1)^2+1} \ dx + \int\frac{2}{(x+1)^2+1} \ dx\end{aligned}$$

先處理左邊的 $\int \frac{x+1}{(x+1)^2+1}\ dx$：利用 $d ((x+1)^2+1) = 2(x+1)\ dx$，左邊

$$ \begin{aligned} \int  \frac{x+1}{(x+1)^2+1} \ dx &= \frac12\int \frac{d ((x+1)^2+1)}{(x+1)^2+1} \\ &= \frac12 \ln|(x+1)^2+1|+C \end{aligned}$$

而右邊的 $\int\frac{2}{(x+1)^2+1}\ dx$ 就是用到剛剛的 $\arctan 公式$。由於 $dx=d(x+1)$，因此

$$ \begin{aligned} \int\frac{2}{(x+1)^2+1}\ dx &= 2\int\frac{1}{(x+1)^2+1}\ d(x+1)\\ &= 2\arctan (x+1)=C \end{aligned}$$

因此結合以上的計算，答案是 $$\frac12 \ln(x^2+2x+2)+2\arctan (x+1)+C.$$

### 定理

遇到一次式除以二次式，要算積分時：

- 分母有兩實根 $\alpha, \beta$，則分解分母，再用部分分式拆成兩個小的，積出兩個 $\ln.$
- 分母有重根 $\alpha$，就把分子寫成 $(x-\alpha)$ 的多項式。
- 分母沒有實根，就把分母配方，積出一個 $\ln$ 與一個 $\arctan.$

> 一次式除以二次式總是可以積分

### 推論

1. **多項式 / 二次式** 總是可以積分（用類似把假分數換成帶分數的方法，可以化成「多項式 + $\frac{一次式}{二次式}$」）

2. **多項式 / 多項式** 總是可以積分（分母可以分解成一些一次式與二次式的乘積，再用部份分式化成 $\frac{一次式}{二次式} + \frac{一次式}{二次式} + \frac{常數}{一次式} + ...$）